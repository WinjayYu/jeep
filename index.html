<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="content-type" content='text/html;charset=utf-8' />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="format-detection" content="telephone=no,address=no" />
    <title>Jeep K8大指挥官</title>
    <link rel="stylesheet" href="./css/reset.css">
    <link rel="stylesheet" href="./css/style.css">
    <style type="text/css">
        /*.loading {*/
        /*background: url('images/loading.gif') no-repeat 50% 20%;*/
        /*background-size: 60%;*/
        /*background-color: #1b1d1c;*/
        /*}*/
        .spritespin-instance {
            margin: 0px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header outer_head">
            <!--<div class="logo"><span>Jeep K8大指挥官</span></div>-->
            <div class="menu">
                <span class="menu_item">换色</span><span class="menu_item">轮毂</span><span class="menu_item">配置</span>
            </div>
            <div class="outside_sub_menu">
                <div class="sub_menu clear">
                    <div class="sub_menu_wrap">
                        <span carcolor="blue" class="sub_menu_item active_item" data-url="./images/1.jpg">地中海蓝</span>
                        <span carcolor="black" class="sub_menu_item " data-url="./images/2.jpg">北极黑</span>
                        <span carcolor="red" class="sub_menu_item " data-url="./images/3.jpg">波尔多红</span>
                        <span carcolor="brown" class="sub_menu_item " data-url="./images/4.jpg">阿布扎比棕</span>
                        <span carcolor="white" class="sub_menu_item " data-url="./images/4.jpg">喀纳斯白</span>
                        <span carcolor="crystal" class="sub_menu_item " data-url="./images/4.jpg">西西里灰</span>
                    </div>
                    <div class="show_more">
                        <img src="./images/CombinedShape.png" alt="">
                    </div>
                </div>
                <div class="sub_menu clear">
                    <div class="sub_menu_wrap">
                        <span carhub="summit" class="sub_menu_item active_item" data-url="./images/3.jpg">Summit</span>
                        <span carhub="overland" class="sub_menu_item" data-url="./images/4.jpg">Overland</span>
                        <span carhub="limited" class="sub_menu_item" data-url="./images/5.jpg">Limited</span>
                    </div>
                    <div class="show_more">
                        <img src="./images/CombinedShape.png" alt="">
                    </div>
                </div>
                <div class="sub_menu clear">
                    <div class="sub_menu_wrap">
                        <span class="sub_menu_item active_item" data-url="./images/5.jpg">行政外观</span>
                        <span class="sub_menu_item" data-url="./images/6.jpg">发动机</span>
                        <span class="sub_menu_item" data-url="./images/7.jpg">变速箱</span>
                        <span class="sub_menu_item" data-url="./images/8.jpg">油耗</span>
                        <span class="sub_menu_item" data-url="./images/9.jpg">人性化科技</span>
                        <span class="sub_menu_item" data-url="./images/9.jpg">核心技术</span>
                    </div>
                    <div class="show_more">
                        <img src="./images/CombinedShape.png" alt="">
                    </div>
                </div>
            </div>
        </div>
        <div class="header inner_head">
            <!--<div class="logo"><span>Jeep K8大指挥官</span></div>-->
            <div class="menu">
                <span class="menu_item">换色</span><span class="menu_item">配置</span><span class="menu_item">视角</span>
            </div>
            <div class="outside_sub_menu">
                <div class="sub_menu clear">
                    <div class="sub_menu_wrap">
                        <span vrcolor="black" class="sub_menu_item  active_item" data-url="./images/1.jpg">黑/黑</span>
                        <span vrcolor="grey" class="sub_menu_item " data-url="./images/2.jpg">黑/灰</span>
                        <span vrcolor="brown" class="sub_menu_item " data-url="./images/3.jpg">黑/棕</span>
                    </div>
                    <div class="show_more">
                        <img src="./images/CombinedShape.png" alt="">
                    </div>
                </div>
                <div class="sub_menu clear">
                    <div class="sub_menu_wrap">
                        <span vrplace="0" class="sub_menu_item active_item" data-url="./images/3.jpg">方向盘</span>
                        <span vrplace="1" class="sub_menu_item" data-url="./images/4.jpg">仪表盘</span>
                        <span vrplace="2" class="sub_menu_item" data-url="./images/5.jpg">安全座椅</span>
                    </div>
                    <div class="show_more">
                        <img src="./images/CombinedShape.png" alt="">
                    </div>
                </div>
                <div class="sub_menu clear">
                    <div class="sub_menu_wrap">
                        <span vrangle="0" class="sub_menu_item active_item" data-url="./images/5.jpg">驾驶位视角</span>
                        <span vrangle="1" class="sub_menu_item" data-url="./images/6.jpg">中排视角</span>
                        <span vrangle="2" class="sub_menu_item" data-url="./images/7.jpg">后排视角</span>
                    </div>
                    <div class="show_more">
                        <img src="./images/CombinedShape.png" alt="">
                    </div>
                </div>
            </div>

        </div>
        <div class="content">
            <!--<img src="./images/0.jpg" alt="" class="car">-->
            <div id="360ShowContent"></div>
            <iframe id="VRShowContent" frameborder="0" class="vr_content"></iframe>
            <div class="describe">
                <p class="des_title">赛道级 2.0T 旗舰动力</p>
                <p class="des_content">
                    FCA 集团全新一代2.0T发动机，同级别最强升功率/升扭矩（汽油机罕见达到
                    200N·m），欧洲进口技术+满足欧六排放标准，全新正时系统、全铝结构、众多高科技加持
                </p>
            </div>
            <div class="reserve lightSpeedIn">立即预定</div>
            <img src="./images/circulation.png" alt="" class="circulation">
        </div>
        <div onclick="Switchover(this)" id="SwitchoverBtn" class="footer">点击进入内饰页</div>
        <div class="box"><div class="boxLoading"></div><p>0%</p></div>
    </div>
    <div class="loading_wrap">
        <img src="./images/loading.gif" alt="" class="loading">
    </div>
    <script src="./js/jquery.min.js"></script>
    <script src="./js/spritespin.min.js"></script>
    <script type="text/javascript">
        //默认选择蓝色
        var SelectedCarColor = "blue";
        //轮毂
        var SelectedCarHub = "summit";
        //内饰颜色
        var SelectedCarHubInteriorColor = "black";
        //内饰选择的角度
        var SelectedCarHubInteriorAngle = 0;
        //内饰选择的位置
        var SelectedCarHubInteriorPlace = [0, 0, 0];
        var $innerHead = $('.inner_head');
        var $head = $('.outer_head');
        var $boxLoading = $('.box');

        $(document).ready(function () {
            var $menuItem = $('.menu_item');
            var $subMenu = $('.sub_menu');
            var $subMenuItem = $('.sub_menu_item');
            var $car = $('.car');
            var index = 1;
            var lastIndex = 1;
            var num = 60;
            var speed = 50;
            var $SwitchoverBtn = $('#SwitchoverBtn');
            // 顶上menu切换
            $menuItem.on('click', function (e) {
                e.stopPropagation();
                var $me = $(this);
                var idx = $me.index();
                $menuItem.removeClass('active_menu');
                $me.addClass('active_menu');
                if ($SwitchoverBtn.text() == '点击进入外观页') {
                    idx = idx + 3;
                }
                $subMenu.removeClass('active_sub_menu');
                $subMenu.eq(idx).addClass('active_sub_menu');
            });
            // 二级菜单
            $subMenuItem.on('click', function (e) {
                e.stopPropagation();
                //$boxLoading.show();
                var $me = $(this);
                $subMenuItem.removeClass('active_item');
                $me.addClass('active_item');
                $car.attr('src', $me.data('url'));
                if ($me.text() === '发动机') {
                    $('.describe').show();
                } else {
                    $('.describe').hide();
                }
                //判断是否是颜色的选择
                if ($me.attr("carcolor") != undefined) {
                    SelectedCarColor = $me.attr("carcolor");
                    Load360();
                }
                //轮毂
                if ($me.attr("carhub") != undefined) {
                    SelectedCarHub = $me.attr("carhub");
                    Load360();
                }
                //内饰颜色
                if ($me.attr("vrcolor") != undefined) {
                    SelectedCarHubInteriorColor = $me.attr("vrcolor");
                    LoadVR();
                }
                //内饰角度
                if ($me.attr("vrangle") != undefined) {
                    var SelectedCarHubInteriorAngle = parseInt($me.attr("vrangle"));
                    //调用if里面的方法
                    $("#VRShowContent")[0].contentWindow.switchover(SelectedCarHubInteriorAngle);
                }
            });
            //加载默认颜色的360
            Load360();
        })
        function Load360() {
            $("#VRShowContent").hide();
            $("#360ShowContent").show();
            var width = window.screen.availWidth;
            var height = (width / 9) * 16;
            var frames = SpriteSpin.sourceArray('./images/' + SelectedCarColor + '_' + SelectedCarHub + '/' + SelectedCarColor + '_' + SelectedCarHub + '_{frame}.jpg', { frame: [0, 60], digits: 3 });
            var loadIndex = 0;
            $("#360ShowContent").spritespin({
                width: width,
                height: height,
                behavior: "drag",
                module: "360",
                sense: -1,
                source: frames,
                animate: false,
                onInit: function () {
                    $(".box").show();
                    loadIndex = 0;
                    console.log("正在加载");
                },
                onProgress: function (a, b, c, d) {
                    loadIndex = loadIndex + 1;
                    var p = parseInt(parseFloat(parseFloat(loadIndex) / frames.length) * 100);
                    $(".box p").html(p + "%");
                },
                onLoad: function () {
                    console.log("加载完成");
                    //$(".box").hide();
                    $(".box p").html("0%");
                    $('.loading_wrap').hide();
                }
            });
            $('.loading_wrap').hide();
        }
        function LoadVR() {
            $("#VRShowContent").show();
            $("#360ShowContent").hide();
            var width = window.screen.availWidth;
            var height = window.screen.availHeight;
            $("#VRShowContent").css("height", (height - 64) + "px");
            $("#VRShowContent").attr("src", "./vr/" + SelectedCarHubInteriorColor + "/index.html");
            $('.container').css('height', $('iframe').height() + 64 + 'px');
            //加载效果
            $(".box").show();
            var pro = 1;
            var t= setInterval(function () {
                pro =parseInt(pro + (Math.random()*10));
                if (pro > 90) {
                    pro = 91;
                }
                $(".box p").html(pro + "%");
                clearInterval(t);
            }, 1000);
        }
        function Switchover(obj) {
            if ($(obj).text() == "点击进入内饰页") {
                $(obj).text("点击进入外观页");
                //内饰
                LoadVR();
                $head.hide();
                $innerHead.show();
            } else {
                $(obj).text("点击进入内饰页");
                //外观
                Load360();
                $innerHead.hide();
                $head.show();
            }
        }
        //加载完毕之后
        function HideLoading() {
            $('.loading_wrap').hide();
            $(".box").hide();
            $(".box p").html("0%");
        }
    </script>
</body>
</html>